{
  "hash": "410e42af1c50763598bc8370149d585e",
  "result": {
    "markdown": "---\ntitle: \"Copula\"\nauthor: \"Aleksandra Muciek\"\ndate: \"2023-06-20\"\ncategories: [Math, theory]\ntoc: true\nformat: \n    html: \n        code-fold: true\n---\n\nWhat are copulas? Why do we need them? How do we use them?\n\n## Copulae - what are they?\n\nCopulae came from the need of modeling relations between random variables. \n\nAssume we have random variables $X$ and $Y$ with distributions $F_X$ and $F_Y$. If they are independent, their joint distribution is given as $F_{X,Y}(x, y) = F_X(x)F_Y(y)$. But what if they are not independent? There are numerous ways the variables could influence each other.\n\nHere comes Copula.\n\nEvery cumulative distribution function with uniform marginals on $U[0,1]$ is called copula. Why is this is useful? Because we know that $F_X(X)$ is uniformly distributed on $[0,1]$. With random variables $X$, $Y$ we can go to uniform random variables by $F_X(X)$, $F_Y(Y)$ and explore their dependance there, on $[0, 1] \\times [0,1]$.\n\n## Existence\n\nCan we do that trick for any pair of $X$ and $Y$? It turns out that yes. \n\nSklar theorem\n\n::: {#thm-line}\n\n## Sklar\n\nIf $F_{(X,Y)}$ is a cdf function of random variables $(X, Y)$ with continuous marginal cdfs $F_X$ and $F_Y$, there exists unique Copula such that\n\n$$\nF_{(X, Y)}(x, y) = C_{(X,Y)}(F_X(x), F_Y(y))\n$$\n:::\n\n:::{.proof}\nTake\n$$\nC_(X, Y)(x, y) := P[F_X(X) \\leq x, F_Y(Y) \\leq y],\n$$\nthen\n$$\nC_(X, Y)(x, y) = F_{(X,Y)} (F^{-1}_X(x), F^{-1}_Y(y)).\n$$\n:::\n\n## Examples\n\nImportant examples:\n\n\n1. Independent $X$ and $Y$\n    $$\n    C^{*} (x, y) = \\min (1, x) \\min (1, y) I_{(0, \\infty) \\times (0, \\infty)} (x, y)\n    $$\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef plot_copula(copula_function, copula_name):\n    x = np.linspace(0, 1, 30)\n    y = np.linspace(0, 1, 30)\n    X, Y = np.meshgrid(x, y)\n    Z = copula_function(X, Y)\n\n\n    fig = plt.figure()\n    ax = plt.axes(projection='3d')\n    ax.contour3D(X, Y, Z, 50) #, cmap='binary')\n    ax.set_xlabel('x')\n    ax.set_ylabel('y')\n    ax.set_title(copula_name)\n    #ax.set_zlabel('Copula')\n\ndef c_star(x, y):\n    return np.minimum([1], x) * np.minimum([1],y)\n\n\nplot_copula(c_star, \"C*\")\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-1.png){width=401 height=409}\n:::\n:::\n\n\n2. Copula plus $C^{+}$\n    This corresponds to maximal dependence between two variables.\n    $$\n    C^{+} = \\min( \\min(1, x), \\min(1, y)) I_{(0, \\infty) \\times (0, \\infty)} (x, y)\n    $$\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndef c_plus(x, y):\n    return np.minimum(np.minimum([1], x), np.minimum([1],y))\n\n\nplot_copula(c_plus, \"C+\")\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-1.png){width=401 height=409}\n:::\n:::\n\n\n3. Copula minus $C^{-}$. This corresponds to maximal negative dependence between two variables.\n    $$\n    C^{-} = max(0, min(1, x) + min (1, y) - 1) I_{(0, \\infty) \\times (0, \\infty)} (x, y)\n    $$\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndef c_minus(x, y):\n    return np.maximum(0, np.minimum([1], x) + np.minimum([1],y) - 1)\n\n\nplot_copula(c_minus, \"C-\")\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-1.png){width=401 height=409}\n:::\n:::\n\n\n## Properties\n\nThe copulae plus and minus bound every other copula:\n\n::: {#thm-bound}\n\n## Frechet\n\nFor any copula\n\n$$\nC^{-} (x, y) \\leq C(x, y) \\leq C^{-} (x, y), \\forall x, y \\in \\mathbb{R}\n$$\n:::\n\nAs every density, copulae have properties:\n\n* $C: \\mathbb{R}^2 \\to [0,1]$ is nondecreasing on every dimension\n* $C(-\\infty, -\\infty) = 0$ and $C(\\infty, \\infty) = 1$, while iterating the limits in any order.\n* $C$ satisfies\n\n$$\nC(\\min(\\mathbf{x},\\mathbf{y})) + C(\\max(\\mathbf{x},\\mathbf{y})) \\geq C(\\mathbf{x}) + C(\\mathbf{y}).\n$$\n\n\n\n\n\n<!-- ## What is a copula?\n\nThey are objects that describe dependance between random variables. \n\nA copula is a multivariate distribution function for which the marginal probability distribution of each variable is uniform on the interval $[0,1]$. Copula describes relations between the variables - there is a theorem that states: *any multivariate joint distribution can be written in terms of univariate marginal distribution functions and a copula.*\n\n\n -->\n\n## Sources:\n\n* https://en.wikipedia.org/wiki/Copula_(probability_theory)#Sklar's_theorem\n* http://www.math.uni.wroc.pl/~szekli/documents/mumio/mumio-16-trans/skrypt-16.pdf\n* https://jakevdp.github.io/PythonDataScienceHandbook/04.12-three-dimensional-plotting.html\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}